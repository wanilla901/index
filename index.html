<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ВКонтакте 2007 года</title>
    <style>
        body {
            background-color: #e6e6e6; /* Светлый фон */
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            color: #333; /* Темный текст */
        }

        h1 {
            text-align: center;
            color: #2a2a2a; /* Темный заголовок */
        }

        #container {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            max-width: 1200px; /* Максимальная ширина контейнера */
            margin: 0 auto; /* Центрирование контейнера */
        }

        #messageBoard, #profileSection {
            width: 48%; /* Ширина обеих секций */
            background-color: white;
            padding: 10px;
            border: 1px solid #ccc; /* Легкий бордер */
            border-radius: 5px; /* Скругленные углы */
            box-shadow: 0 0 5px rgba(0, 0, 0, 0.1); /* Легкая тень */
            max-height: 400px;
            overflow-y: auto;
        }

        h2 {
            font-size: 1.5em;
            color: #007BFF; /* Синий цвет для заголовков */
            margin-bottom: 10px;
        }

        .message, .profile, .post {
            border: 1px solid #ddd; /* Светлый бордер */
            padding: 5px;
            margin-bottom: 5px;
            border-radius: 3px; /* Скругленные углы */
            background-color: #f9f9f9; /* Светлый фон для сообщений и профилей */
        }

        img {
            max-width: 50px;
            border-radius: 50%; /* Круглые изображения */
            float: left; /* Плавающее изображение */
            margin-right: 10px; /* Отступ справа для текста */
        }

        .post img {
            max-width: 100%; /* Изображения в постах будут занимать 100% ширины контейнера */
            border-radius: 5px; /* Скругленные углы для изображений постов */
            margin-top: 10px; /* Отступ сверху */
        }

        input[type="text"], input[type="file"], input[type="password"], input[type="submit"] {
            width: calc(100% - 12px); /* Учитываем отступы */
            margin-bottom: 10px;
            padding: 5px;
            border-radius: 3px; /* Скругленные углы */
            border: 1px solid #ccc; /* Легкий бордер */
        }

        input[type="submit"] {
            background-color: #007BFF; /* Синий цвет для кнопки */
            color: white;
            border: none;
            cursor: pointer;
        }

        input[type="submit"]:hover {
            background-color: #0056b3; /* Темно-синий при наведении */
        }

        .delete-button {
            background-color: transparent; /* Прозрачный фон */
            color: #007BFF; /* Синий цвет текста */
            border: none; /* Без бордера */
            cursor: pointer; /* Указатель при наведении */
            font-size: 0.9em; /* Уменьшенный размер шрифта */
            margin-top: 5px; /* Отступ сверху */
        }

        .delete-button:hover {
            text-decoration: underline; /* Подчеркивание при наведении */
            color: #0056b3; /* Темно-синий при наведении */
        }

        .comment {
            margin-top: 5px; /* Отступ сверху для комментариев */
            padding: 5px;
            border: 1px solid #ccc; /* Легкий бордер для комментариев */
            border-radius: 3px; /* Скругленные углы */
            background-color: #f0f0f0; /* Светлый фон для комментариев */
        }

        footer {
            text-align: center; 
            margin-top: 20px;
            color: #777; /* Светло-серый цвет текста */
        }
    </style>
    <!-- Подключение Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com.firebasejs/9.6.1/firebase-firestore.js"></script>
</head>
<body>
    <h1>Помощник с калькулятором</h1>
    <div id="container">
        <!-- Область сообщений -->
        <div id="messageBoard">
            <h2>Общая доска сообщений</h2>
            <div id="messages"></div>
            <form id="messageForm" onsubmit="postMessage(); return false;">
                <input type="text" id="messageInput" placeholder="Напишите сообщение" required>
                <input type="submit" value="Отправить сообщение">
            </form>
        </div>

        <!-- Область профилей -->
        <div id="profileSection">
            <h2>Создание профиля</h2>
            <form id="profileForm" onsubmit="createProfile(); return false;">
                <input type="text" id="username" placeholder="Имя пользователя" required>
                <input type="text" id="bio" placeholder="Краткая информация о себе" required>
                <input type="password" id="password" placeholder="Пароль" required>
                <input type="file" id="profilePhoto" accept="image/*">
                <input type="submit" value="Создать профиль">
            </form>
            <div id="profiles"></div>
        </div>
    </div>

    <h2>Публикация фото</h2>
    <div id="photoSection">
        <form id="photoForm" onsubmit="postPhoto(); return false;">
            <input type="file" id="photoInput" accept="image/*" required>
            <input type="text" id="photoDescription" placeholder="Описание фотографии" required>
            <input type="submit" value="Опубликовать фото">
        </form>
        <div id="posts"></div>
    </div>

    <script>
        // Инициализация Firebase
        const firebaseConfig = {
            apiKey: "YOUR_API_KEY", // Замените YOUR_API_KEY на ваш API ключ
            authDomain: "YOUR_AUTH_DOMAIN", // Замените YOUR_AUTH_DOMAIN на ваш домен аутентификации
            projectId: "YOUR_PROJECT_ID", // Замените YOUR_PROJECT_ID на ID вашего проекта
            storageBucket: "YOUR_STORAGE_BUCKET", // Замените YOUR_STORAGE_BUCKET на ваш бакет
            messagingSenderId: "YOUR_MESSAGING_SENDER_ID", // Замените YOUR_MESSAGING_SENDER_ID на ID отправителя сообщений
            appId: "YOUR_APP_ID" // Замените YOUR_APP_ID на ID вашего приложения
        };

        const app = firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // Загружаем сохраненные сообщения, профили и посты из Firestore при загрузке страницы
        window.onload = function() {
            loadMessages();
            loadProfiles();
            loadPosts();
        };

        // Функция для публикации сообщения
        function postMessage() {
            const messageInput = document.getElementById("messageInput").value;

            // Добавление нового сообщения в Firestore
            db.collection("messages").add({
                text: messageInput,
                timestamp: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                displayMessages();
                document.getElementById("messageInput").value = ""; // очищаем поле ввода
            }).catch(error => {
                console.error("Ошибка добавления сообщения: ", error);
            });
        }

        // Функция для отображения сообщений
        function displayMessages() {
            const messagesBoard = document.getElementById("messages");
            messagesBoard.innerHTML = ""; // очищаем текущее содержание

            // Получение сообщений из Firestore
            db.collection("messages").orderBy("timestamp").onSnapshot(snapshot => {
                snapshot.forEach(doc => {
                    const message = doc.data().text;
                    const newMessage = document.createElement("div");
                    newMessage.className = "message";
                    newMessage.textContent = message;

                    // Добавляем кнопку удаления
                    const deleteButton = document.createElement("button");
                    deleteButton.textContent = "Удалить";
                    deleteButton.className = "delete-button";
                    deleteButton.onclick = function() {
                        deleteMessage(doc.id);
                    };
                    newMessage.appendChild(deleteButton);
                    
                    messagesBoard.appendChild(newMessage);
                });
            });
        }

        // Функция для удаления сообщения
        function deleteMessage(id) {
            db.collection("messages").doc(id).delete().then(() => {
                console.log("Сообщение успешно удалено");
            }).catch(error => {
                console.error("Ошибка удаления сообщения: ", error);
            });
        }

        // Функция для создания профиля
        function createProfile() {
            const username = document.getElementById("username").value;
            const bio = document.getElementById("bio").value;
            const password = document.getElementById("password").value;
            const profilePhoto = document.getElementById("profilePhoto").files[0];

            const storageRef = firebase.storage().ref();
            const photoRef = storageRef.child('profilePhotos/' + profilePhoto.name);

            photoRef.put(profilePhoto).then(() => {
                return photoRef.getDownloadURL();
            }).then(url => {
                return db.collection("profiles").add({
                    username: username,
                    bio: bio,
                    password: password,
                    photoUrl: url
                });
            }).then(() => {
                displayProfiles();
                document.getElementById("profileForm").reset(); // очищаем форму
            }).catch(error => {
                console.error("Ошибка создания профиля: ", error);
            });
        }

        // Функция для отображения профилей
        function displayProfiles() {
            const profilesSection = document.getElementById("profiles");
            profilesSection.innerHTML = ""; // очищаем текущее содержание

            // Получение профилей из Firestore
            db.collection("profiles").get().then(snapshot => {
                snapshot.forEach(doc => {
                    const profile = doc.data();
                    const newProfile = document.createElement("div");
                    newProfile.className = "profile";

                    newProfile.innerHTML = `
                        <img src="${profile.photoUrl}" alt="${profile.username}">
                        <strong>${profile.username}</strong><br>
                        <span>${profile.bio}</span>
                    `;

                    profilesSection.appendChild(newProfile);
                });
            });
        }

        // Функция для публикации фото
        function postPhoto() {
            const photoInput = document.getElementById("photoInput").files[0];
            const photoDescription = document.getElementById("photoDescription").value;

            const storageRef = firebase.storage().ref();
            const photoRef = storageRef.child('photos/' + photoInput.name);

            photoRef.put(photoInput).then(() => {
                return photoRef.getDownloadURL();
            }).then(url => {
                return db.collection("posts").add({
                    description: photoDescription,
                    photoUrl: url,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp()
                });
            }).then(() => {
                displayPosts();
                document.getElementById("photoForm").reset(); // очищаем форму
            }).catch(error => {
                console.error("Ошибка публикации фото: ", error);
            });
        }

        // Функция для загрузки постов
        function loadPosts() {
            const postsSection = document.getElementById("posts");
            postsSection.innerHTML = ""; // очищаем текущее содержание

            db.collection("posts").orderBy("timestamp").onSnapshot(snapshot => {
                snapshot.forEach(doc => {
                    const post = doc.data();
                    const newPost = document.createElement("div");
                    newPost.className = "post";

                    newPost.innerHTML = `
                        <img src="${post.photoUrl}" alt="Фото поста">
                        <p>${post.description}</p>
                    `;

                    postsSection.appendChild(newPost);
                });
            });
        }

        // Функция для загрузки сообщений
        function loadMessages() {
            displayMessages();
        }

        // Функция для загрузки профилей
        function loadProfiles() {
            displayProfiles();
        }
    </script>

    <footer>
        <p>&copy; 2024 Помощник с калькулятором. Все права защищены.</p>
    </footer>
</body>
</html>

</html>



